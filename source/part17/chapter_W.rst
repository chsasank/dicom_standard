.. _chapter_W:

Digital Signatures in Structured Reports Use Cases (Informative)
================================================================

The scenarios in which Digital Signatures would be used in DICOM
Structured Reports include, but are not limited to the following.

Case 1: Human Signed Report and Automatically Signed Evidence.

a. The archive, after receiving an MPPS complete and determining that it
   has the complete set of objects created during an acquisition
   procedure step, creates a signed Key Object Selection Document
   Instance with secure references to all of the DICOM composite objects
   that constitute the exam. The Document would include a Digital
   Signature according to the Basic SR Digital Signatures Secure Use
   Profile with the Digital Signature Purpose Code Sequence (0400,0401)
   of (14,ASTM-sigpurpose, "Source Signature"). It would set the Key
   Object Selection Document Title of that Instance to (113035, DCM,
   "Signed Complete Acquisition Content"). Note that the objects that
   are referenced in the MPPS may or may not have Digital Signatures. By
   creating the Key Object Selection Document Instance, the archive can
   in effect add the equivalent of Digital Signatures to the set of
   objects.

b. A post-processing system generates additional evidence objects, such
   as measurements or CAD reports, referring to objects in the exam.
   This post-processing system may or may not include Digital Signatures
   in the evidence objects, and may or may not be included as secure
   references in a signed Key Object Selection Document.

c. Working at a reporting station, a report author gathers evidences
   from a variety of sources, including those referenced by the Key
   Object Selection Document Instance and the additional evidence
   objects generated by the post-processing system, and incorporates his
   or her own observations and conclusions into one or more reports.

d. It is desired that all evidence references from a DICOM SR be secure.
   The application creating the SR may either:

   1. create secure references by copying a verified Digital Signature
      from the referenced object or by generating a MAC code directly
      from the referenced object,.

   2. make a secure reference to a signed Key Object Selection Document
      that in turn securely references the SOP Instances, or.

   3. copy the secure reference information from a trusted Key Object
      Selection Document to avoid the overhead of recalculating the MAC
      codes or revalidating the reference Digital Signatures.

e. When the author completes a DICOM SR, the system, using the author's
   X.509 Digital Signature Certificate generates a Digital Signature
   with the Digital Signature Purpose Code Sequence (0400,0401) of (1,
   ASTM-sigpurpose, "Author Signature") for the report.

f. The author's supervisor reviews the DICOM SR. If the supervisor
   approves of the report, the system sets the Verification Flag to
   "VERIFIED" and adds a Digital Signature with the Digital Signature
   Purpose Code Sequence (0400,0401) of (5, ASTM-sigpurpose,
   "Verification Signature") or (6, ASTM-sigpurpose, "Validation
   Signature") using the supervisor's X.509 certificate.

g. At some later time, someone who is reading the DICOM SR SOP Instance
   wishes to verify its authenticity. The system would verify that the
   Author Signature, as well as any Verification or Validation Signature
   present are intact (i.e., that the signed data has not been altered
   based on the recorded Digital Signatures, and that the X.509
   Certificates were valid at the time that the report was created).

h. If the report reader wishes to inspect DICOM source materials
   referenced in a DICOM SR, the system can insure that the materials
   have not been altered since the report was written by verifying the
   Referenced Digital Signatures or the Referenced SOP Instance MAC that
   the report creator generated from the referenced materials.

Case 2: Cross Enterprise Document Exchange

a. An application sends by any means a set of DICOM composite objects to
   an entity outside of the institutional environment (e.g., for review
   by a third party).

b. The application creates a signed Key Object Selection Document
   Instance with a Key Object Selection Document Title of (113031, DCM,
   "Signed Manifest") referencing the set of DICOM Data Objects that it
   sent outside the institutional environment, and sends that SR to the
   external entity as a shipping manifest.

c. The external entity may utilize the Key Object Selection SR SOP
   Instance to confirm that it received all of the referenced objects
   intact (i.e., without alterations). Because the signed Key Object
   Selection Instance must use secure references, it can verify that the
   objects have not been modified.

